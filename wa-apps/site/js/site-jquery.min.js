jQuery.fn.waDialog=function(a){a=jQuery.extend({loading_header:"",title:"",esc:!0,buttons:null,url:null,url_reload:!0,"class":null,content:null,width:0,height:0,"min-width":0,"min-height":0,offsetTop:null,offsetLeft:null,disableButtonsOnSubmit:!1,onLoad:null,onCancel:null,onSubmit:null},a||{});var b=$(this),c=b.attr("id");c&&!b.hasClass("dialog")&&(b.removeAttr("id"),$("#"+c).length&&(a.url?(b=$("#"+c),a.url_reload||(a.url=null)):$("#"+c).remove()));var d=a["class"]||a.className?a["class"]||a.className:
b.attr("class")||"";if(b.hasClass("dialog"))a.content&&(b.find(".dialog-content-indent").html(a.content),a.title&&b.find(".dialog-content-indent").prepend("<h1>"+a.title+"</h1>")),a.buttons&&b.find(".dialog-buttons-gradient").empty().append(a.buttons);else{var f=$(this),b=$("<div "+(c?'id = "'+c+'"':"")+' class="dialog '+d+'" style="display: none"><div class="dialog-background"></div><div class="dialog-window"></div></div>').appendTo("body");f.find(".dialog-content").length||f.find(".dialog-buttons").length?
($(".dialog-window",b).append(f.show()),c=f.find(".dialog-content"),c.length&&(d=$('<div class="dialog-content-indent"></div>'),c.contents().appendTo(d),c.append(d)),c=f.find(".dialog-buttons"),c.length&&(d=$('<div class="dialog-buttons-gradient"></div>'),c.contents().appendTo(d),c.append(d))):($(".dialog-window",b).append((a.onSubmit?'<form method="post" action="">':"")+'<div class="dialog-content"><div class="dialog-content-indent"></div></div><div class="dialog-buttons"><div class="dialog-buttons-gradient"></div></div>'+
(a.onSubmit?"</form>":"")),b.find(".dialog-content-indent").append(f.show()));a.buttons&&b.find(".dialog-buttons-gradient").empty().append(a.buttons);a.url?b.find(".dialog-content-indent").append("<h1>"+(a.loading_header||"")+'<i class="icon16 loading"></i></h1>'):a.content&&b.find(".dialog-content-indent").append(a.content);a.title&&b.find(".dialog-content-indent").prepend("<h1>"+a.title+"</h1>")}b.find(".dialog-background").length||b.prepend('<div class="dialog-background"> </div>');b.unbind("close").bind("close",
function(){a.onClose&&a.onClose.call($(this));$(this).hide()});f=["width","height","min-width","min-height"];for(c=0;c<f.length;c++)a[f[c]]&&(("height"==f[c]&&"300px">a[f[c]]||"width"==f[c]&&"400px">a[f[c]])&&b.find("div.dialog-window").css("min-"+f[c],a[f[c]]),b.find("div.dialog-window").css(f[c],a[f[c]]));a.disableButtonsOnSubmit&&b.find("input[type=submit]").removeAttr("disabled");b.parent().length||b.appendTo("body");b.show();a.url?jQuery.get(a.url,function(c){var f=$(c);f.find(".dialog-content").length||
f.find(".dialog-buttons").length?(f.find(".dialog-content").length&&b.find(".dialog-content-indent").empty().append(f.find(".dialog-content").contents()),f.find(".dialog-buttons").length&&b.find(".dialog-buttons-gradient").empty().append(f.find(".dialog-buttons").contents())):b.find(".dialog-content-indent").html(c);b.trigger("wa-resize");a.onLoad&&a.onLoad.call(b.get(0))}):a.onLoad&&a.onLoad.call(b.get(0));b.find(".dialog-buttons").delegate(".cancel","click",function(f){f.stopPropagation();f.preventDefault();
a.onCancel&&a.onCancel.call(b.get(0));b.trigger("close");return!1});a.onSubmit&&b.find("form").unbind("submit").submit(function(){a.disableButtonsOnSubmit&&b.find("input[type=submit]").attr("disabled","disabled");return a.onSubmit.apply(this,[b])});b.unbind("wa-resize").bind("wa-resize",function(){var b=jQuery(this).find(".dialog-window"),f=b.width(),c=b.height();jQuery("body").css("min-height",c+"px");var d=jQuery(window).width(),m=jQuery(window).height()-60,f=(d-f)/2/d,c=(m-c-60)/2/m;0>c&&(c=0);
0>f&&(f=0);b.css({left:a.offsetLeft||Math.round(100*f)+"%",top:a.offsetTop||Math.round(100*c)+"%"})}).trigger("wa-resize");a.esc&&b.unbind("esc").bind("esc",function(){b.trigger("close")});return b};jQuery(window).resize(function(){jQuery(".dialog:visible").trigger("wa-resize")});jQuery(document).keyup(function(a){27==a.keyCode&&jQuery(".dialog:visible").trigger("esc")});/*
 (c) 2008-2009 Benjamin Arthur Lupton {@link http://www.balupton.com}
 @license GNU Affero General Public License - {@link http://www.gnu.org/licenses/agpl.html}
 @example Visit {@link http://jquery.com/plugins/project/jquery_history_bal} for more information.


 I would like to take this space to thank the following projects, blogs, articles and people:
 - jQuery {@link http://jquery.com/}
 - jQuery UI History - Klaus Hartl {@link http://www.stilbuero.de/jquery/ui_history/}
 - Really Simple History - Brian Dillard and Brad Neuberg {@link http://code.google.com/p/reallysimplehistory/}
 - jQuery History Plugin - Taku Sano (Mikage Sawatari) {@link http://www.mikage.to/jquery/jquery_history.html}
 - jQuery History Remote Plugin - Klaus Hartl {@link http://stilbuero.de/jquery/history/}
 - Content With Style: Fixing the back button and enabling bookmarking for ajax apps - Mike Stenhouse {@link http://www.contentwithstyle.co.uk/Articles/38/fixing-the-back-button-and-enabling-bookmarking-for-ajax-apps}
 - Bookmarks and Back Buttons {@link http://ajax.howtosetup.info/options-and-efficiencies/bookmarks-and-back-buttons/}
 - Ajax: How to handle bookmarks and back buttons - Brad Neuberg {@link http://dev.aol.com/ajax-handling-bookmarks-and-back-button}



 CHANGELOG

 v1.0.1-final, July 11, 2009
 - Restructured a little bit
 - Documented
 - Cleaned go/request

 v1.0.0-final, June 19, 2009
 - Been stable for over a year now, pushing live.

 v0.1.0-dev, July 24, 2008
 - Initial Release

*/
(function(a){"undefined"===typeof console&&(console="undefined"!==typeof window.console?window.console:{});console.log=console.log||function(){};console.debug=console.debug||console.log;console.warn=console.warn||console.log;console.error=console.error||function(){for(var a=[],c=0;c<arguments.length;c++)a.push(arguments[c]);alert(a.join("\n"))};console.trace=console.trace||console.log;console.group=console.group||console.log;console.groupEnd=console.groupEnd||console.log;console.profile=console.profile||
console.log;console.profileEnd=console.profileEnd||console.log;a.History={options:{debug:!1},state:"",$window:null,$iframe:null,handlers:{generic:[],specific:{}},format:function(a){return a=a.replace(/^.+?#/g,"").replace(/^#?\/?|\/?$/g,"")},getState:function(){return a.History.state},setState:function(b){var c=a.History;b=c.format(b);c.state=b;return c.state},getHash:function(){var b=parent&&!a.browser.msie?parent.window.location.hash:window.location.hash||location.hash;return b=a.History.format(b)},
setHash:function(b){b=a.History.format(b);b=b.replace(/^\/?|\/?(\?)|\/?$/g,"/$1");"undefined"===typeof window.location.hash&&(location.hash=b);a.browser.msie&&8>parseInt(a.browser.version,10)&&(a.History.$iframe.contentWindow.document.open(),a.History.$iframe.contentWindow.document.close())},go:function(b){var c=a.History;b=c.format(b);c.getHash()!==b?c.setHash(b):(c.setState(b),c.trigger());return!0},hashchange:function(b){var c=a.History;c.options.debug&&console.debug("History.hashchange",this,
arguments);var d=c.getHash(),f=c.getState();if(!c.$iframe&&f===d||c.$iframe&&c.hash===c.$iframe.contentWindow.document.location.hash||f===d)return!1;c.setState(d);c.trigger();return!0},bind:function(b,c){var d=a.History;c?("undefined"===typeof d.handlers.specific[b]&&(d.handlers.specific[b]=[]),d.handlers.specific[b].push(c)):d.handlers.generic.push(b);return!0},trigger:function(b){var c=a.History;"undefined"===typeof b&&(b=c.getState());var d,f,e,g;if("undefined"!==typeof c.handlers.specific[b])for(g=
c.handlers.specific[b],d=0,f=g.length;d<f;++d)e=g[d],e(b);g=c.handlers.generic;d=0;for(f=g.length;d<f;++d)e=g[d],e(b);return!0},construct:function(){var b=a.History;a(document).ready(function(){b.domReady()});return!0},configure:function(b){var c=a.History;c.options=a.extend(c.options,b);return!0},domReadied:!1,domReady:function(){var b=a.History;if(!b.domRedied)return b.domRedied=!0,b.$window=a(window),b.$window.bind("hashchange",this.hashchange),setTimeout(b.hashchangeLoader,200),!0},hashchangeLoader:function(){var b=
a.History;if(a.browser.msie&&8<=parseInt(a.browser.version))(c=b.getHash())&&b.$window.trigger("hashchange");else{if(a.browser.msie){b.$iframe=a('<iframe id="jquery-history-iframe" style="display: none;"></$iframe>').prependTo(document.body)[0];b.$iframe.contentWindow.document.open();b.$iframe.contentWindow.document.close();var c=b.getHash();c&&(b.$iframe.contentWindow.document.location.hash=c);c=function(){var a=b.format(b.$iframe.contentWindow.document.location.hash);b.getState()!==a&&b.setHash(b.$iframe.contentWindow.document.location.hash);
a=b.getHash();b.getState()!==a&&b.go(a)}}else c=function(){var a=b.getHash();b.getState()!==a&&b.go(a)};a.browser.msie&&8>parseInt(a.browser.version)?setInterval(c,1500):setInterval(c,200)}return!0}};a.History.construct()})(jQuery);$.wa=$.ui?$.extend(!0,$.wa,$.ui):{};
$.wa=$.extend(!0,$.wa,{data:{},get:function(a,b){return void 0==a?this.data:this.data[name]||b||null},set:function(a,b){if(void 0==a)return this.data;"object"==typeof a?$.extend(this.data,a):this.data[a]=value;return this.data},encodeHTML:function(a){return a&&(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},decodeHTML:function(a){return a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},setHash:function(a){a instanceof String||!a.toString||(a=a.toString());
a=a.replace(/\/\//g,"/");a=a.replace(/^.*#/,"");$.browser&&$.browser.safari?parent?parent.window.location=parent.window.location.href.replace(/#.*/,"")+"#"+a:window.location=location.href.replace(/#.*/,"")+"#"+a:!parent||$.browser&&$.browser.msie?location.hash=a:parent.window.location.hash=a;return!0},back:function(a){2<history.length?"number"==typeof a&&parseInt(a)==a?history.go(-a):history.go(-1):$.browser.msie&&0<history.length?history.back():a&&this.setHash(a);return!1},toggleHashParam:function(a){-1==
location.hash.search(a)?this.addToHash(a):this.removeFromHash(a)},addToHash:function(a){var b=location.hash;-1==b.search(a)&&(b+="/"+a+"/");this.setHash(b)},removeFromHash:function(a){var b=location.hash;-1<b.search(a)&&(b=b.replace(a,""));this.setHash(b)},setTitle:function(a){document.title=a},array_search:function(a,b,c){c=!!c;for(var d in b)if(c&&b[d]===a||!c&&b[d]==a)return d;return!1},dialogCreate:function(a,b){b=$.extend({content:'<h1>Loading... <i class="icon16 loading"></i></h1>',buttons:null,
url:null,post:null,small:!1,onload:null,oncancel:null},b);b.content=$(b.content);b.buttons=b.buttons?$(b.buttons):$('<input type="submit" class="button gray" value="'+$_("Cancel")+'">').click(function(){b.oncancel&&b.oncancel.call(c[0]);$.wa.dialogHide()});var c=$("#"+a);0>=c.size()&&(c=$('<div class="dialog" id="'+a+'" style="display: none"><div class="dialog-background"></div><div class="dialog-window"><div class="dialog-content"><div class="dialog-content-indent"></div></div><div class="dialog-buttons"><div class="dialog-buttons-gradient"></div></div></div></div>').appendTo("body"));
c.find(".dialog-buttons-gradient").empty().append(b.buttons);c.find(".dialog-content-indent").empty().append(b.content);c.show();b.small?c.addClass("small"):c.removeClass("small");if(b.url){var d=function(a){c.find(".dialog-content-indent").html(a);$.wa.waCenterDialog(c);b.onload&&b.onload.call(c[0])};b.post?$.post(b.url,b.post,d):$.get(b.url,d)}this.waCenterDialog(c);var f=function(a){if(c.is(":visible"))if(a&&27==a.keyCode)b.oncancel&&"function"==typeof b.oncancel&&b.oncancel.call(c[0]),$.wa.dialogHide();
else $(document).one("keyup",f)};f();$(document).one("hashchange",$.wa.dialogHide);return c},waCenterDialog:function(a){a=$(a);a=a.find(".dialog-window");var b=a.outerWidth(!0),c=a.outerHeight(!0),d=$(window).width(),f=$(window).height(),c=(f-c)/2/f;a.css({left:Math.round((d-b)/2/d*100)+"%",top:Math.round(100*c)+"%"})},dialogHide:function(){$(".dialog").hide();return!1},dropdownsClose:function(){var a=$(".dropdown:not(.disabled)");a.addClass("disabled");setTimeout(function(){a.removeClass("disabled")},
600)},dropdownsCloseEnable:function(){$(document).on("click",".dropdown:not(.disabled)",this.dropdownsClickHandler)},dropdownsCloseDisable:function(){$(document).off("click",".dropdown:not(.disabled)",this.dropdownsClickHandler)},dropdownsClickHandler:function(a){var b=$(this);b.hasClass("no-click-close")||(b.addClass("disabled"),setTimeout(function(){b.removeClass("disabled")},600))},defaultInputValue:function(a,b,c){a instanceof jQuery||(a=$(a));var d=function(){var f=a.val();f&&f!=b||(a.val(b),
a.addClass(c))};d();a.blur(d);a.focus(function(){a.hasClass(c)&&(a.removeClass(c),a.val(""))})},util:{formatFileSize:function(a){var b=-1;do a/=1024,b++;while(99<a);return Math.max(a,.01).toFixed(2)+(0<=b?" "+$_("kB MB GB TB PB EB".split(" ")[b]):"")}}});
$(document).ajaxError(function(a,b,c,d){if(200!==b.status&&b.responseText){if(!$.wa.errorHandler||$.wa.errorHandler(b))-1!=b.responseText.indexOf("Exception")?$.wa.dialogCreate("ajax-error",{content:"<div>"+b.responseText+"</div>"}):(document.open("text/html"),document.write(b.responseText),document.close(),$(window).one("hashchange",function(){window.location.reload()}))}else b.getResponseHeader("wa-session-expired")?window.location.reload():"undefined"!==typeof b.responseText&&-1!=b.responseText.indexOf("Exception")&&
$.wa.dialogCreate("ajax-error",{content:"<div>"+b.responseText+"</div>"})});$.ajaxSetup({cache:!1});$(document).ajaxSend(function(a,b,c){"POST"==c.type&&(a=(a=document.cookie.match(/(?:^|; )_csrf=([^;]*)/))?decodeURIComponent(a[1]):"",null===c.data&&(c.data=""),"string"==typeof c.data?-1==c.data.indexOf("_csrf=")&&(c.data+=(0<c.data.length?"&":"")+"_csrf="+a,b.setRequestHeader("Content-type","application/x-www-form-urlencoded")):"object"==typeof c.data&&(c.data._csrf=a))});
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c=this.length,d=Number(b)||0,d=0>d?Math.ceil(d):Math.floor(d);for(0>d&&(d+=c);d<c;d++)if(d in this&&this[d]===a)return d;return-1});$.wa.locale=$.wa.locale||{};
$_=function(a,b){if(b){if(!$.wa.locale[b])return console&&console.log("Localization failed: "+b),b;if("string"==typeof $.wa.locale[b])return $.wa.locale[b];var c=a%10;return 1==Math.floor(a/10)%10||4<c||0==c?$.wa.locale[b][2]:1==c?$.wa.locale[b][0]:$.wa.locale[b][1]}if($.wa.locale[a])return"string"==typeof $.wa.locale[a]?$.wa.locale[a]:$.wa.locale[a][0];console&&console.log("Localization failed: "+a);return a};jQuery.JSON={useHasOwn:{}.hasOwnProperty?!0:!1,pad:function(a){return 10>a?"0"+a:a},m:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},encodeString:function(a){return/["\\\x00-\x1f]/.test(a)?'"'+a.replace(/([\x00-\x1f\\"])/g,function(a,c){var d=jQuery.JSON.m[c];if(d)return d;d=c.charCodeAt();return"\\u00"+Math.floor(d/16).toString(16)+(d%16).toString(16)})+'"':'"'+a+'"'},encodeArray:function(a){var b=["["],c,d,f=a.length,e;for(d=0;d<f;d+=1)switch(e=a[d],typeof e){case "undefined":case "function":case "unknown":break;
default:c&&b.push(","),b.push(null===e?"null":this.encode(e)),c=!0}b.push("]");return b.join("")},encodeDate:function(a){return'"'+a.getFullYear()+"-"+pad(a.getMonth()+1)+"-"+pad(a.getDate())+"T"+pad(a.getHours())+":"+pad(a.getMinutes())+":"+pad(a.getSeconds())+'"'},encode:function(a){if("undefined"==typeof a||null===a)return"null";if(a instanceof Array)return this.encodeArray(a);if(a instanceof Date)return this.encodeDate(a);if("string"==typeof a)return this.encodeString(a);if("number"==typeof a)return isFinite(a)?
String(a):"null";if("boolean"==typeof a)return String(a);var b=["{"],c,d,f;for(d in a)if(!this.useHasOwn||a.hasOwnProperty(d))switch(f=a[d],typeof f){case "undefined":case "function":case "unknown":break;default:c&&b.push(","),b.push(this.encode(d),":",null===f?"null":this.encode(f)),c=!0}b.push("}");return b.join("")},decode:function(a){return eval("("+a+")")}};(function(a,b){a.store=function(b,d){var f=this;if("string"==typeof b)if(a.store.drivers[b])this.driver=a.store.drivers[b];else throw Error("Unknown driver "+b);else if("object"==typeof b){if(!(a.isFunction(b.init)&&a.isFunction(b.get)&&a.isFunction(b.set)&&a.isFunction(b.del)&&a.isFunction(b.flush)))throw Error("The specified driver does not fulfill the API requirements");this.driver=b}else a.each(a.store.drivers,function(){if(!a.isFunction(this.available)||!this.available())return!0;f.driver=this;
return!1===f.driver.init()?(f.driver=null,!0):!1});d||(d=a.store.serializers);this.serializers={};a.each(d,function(b,c){if(!a.isFunction(this.init))return!0;f.serializers[b]=this;f.serializers[b].init(f.encoders,f.decoders)})};a.extend(a.store.prototype,{get:function(a){a=this.driver.get(a);return this.driver.encodes?a:this.unserialize(a)},set:function(a,b){this.driver.set(a,this.driver.encodes?b:this.serialize(b))},del:function(a){this.driver.del(a)},flush:function(){this.driver.flush()},driver:b,
encoders:[],decoders:[],serialize:function(b){var d=this;a.each(this.encoders,function(){var a=d.serializers[this+""];if(!a||!a.encode)return!0;try{b=a.encode(b)}catch(e){}});return b},unserialize:function(b){var d=this;if(!b)return b;a.each(this.decoders,function(){var a=d.serializers[this+""];if(!a||!a.decode)return!0;b=a.decode(b)});return b}});a.store.drivers={localStorage:{ident:"$.store.drivers.localStorage",scope:"browser",available:function(){try{return!!window.localStorage}catch(a){return!1}},
init:a.noop,get:function(a){return window.localStorage.getItem(a)},set:function(a,b){window.localStorage.setItem(a,b)},del:function(a){window.localStorage.removeItem(a)},flush:function(){window.localStorage.clear()}},userData:{ident:"$.store.drivers.userData",element:null,nodeName:"userdatadriver",scope:"browser",initialized:!1,available:function(){try{return!(!document.documentElement||!document.documentElement.addBehavior)}catch(a){return!1}},init:function(){if(!this.initialized)try{this.element=
document.createElement(this.nodeName),document.documentElement.insertBefore(this.element,document.getElementsByTagName("title")[0]),this.element.addBehavior("#default#userData"),this.initialized=!0}catch(a){return!1}},get:function(a){this.element.load(this.nodeName);return this.element.getAttribute(a)},set:function(a,b){this.element.setAttribute(a,b);this.element.save(this.nodeName)},del:function(a){this.element.removeAttribute(a);this.element.save(this.nodeName)},flush:function(){this.element.expires=
(new Date).toUTCString();this.element.save(this.nodeName)}},windowName:{ident:"$.store.drivers.windowName",scope:"window",cache:{},encodes:!0,available:function(){return!0},init:function(){this.load()},save:function(){window.name=a.store.serializers.json.encode(this.cache)},load:function(){try{this.cache=a.store.serializers.json.decode(window.name+""),"object"!=typeof this.cache&&(this.cache={})}catch(b){this.cache={},window.name="{}"}},get:function(a){return this.cache[a]},set:function(a,b){this.cache[a]=
b;this.save()},del:function(a){try{delete this.cache[a]}catch(d){this.cache[a]=b}this.save()},flush:function(){window.name="{}"}}};a.store.serializers={json:{ident:"$.store.serializers.json",init:function(a,b){a.push("json");b.push("json")},encode:"object"==typeof JSON?JSON.stringify:a.JSON.stringify,decode:"object"==typeof JSON?JSON.parse:a.JSON.parse},xml:{ident:"$.store.serializers.xml",init:function(a,b){a.unshift("xml");b.push("xml")},isXML:function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?
"html"!==a.nodeName.toLowerCase():!1},encode:function(a){if(!a||a._serialized||!this.isXML(a))return a;var b={_serialized:this.ident,value:a};try{return b.value=(new XMLSerializer).serializeToString(a),b}catch(f){try{return b.value=a.xml,b}catch(e){}}return a},decode:function(a){if(!a||!a._serialized||a._serialized!=this.ident)return a;var d="DOMParser"in window&&(new DOMParser).parseFromString;!d&&window.ActiveXObject&&(d=function(a){var b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a);
return b});if(!d)return b;a.value=d.call("DOMParser"in window&&new DOMParser||window,a.value,"text/xml");return this.isXML(a.value)?a.value:b}}}})(jQuery);(function(a,b){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,f={},e=a.fn.position,g=a.fn.offset;a.fn.position=function(b){if(!b||!b.of)return e.apply(this,arguments);b=a.extend({},b);var g=a(b.of),m=g[0],l=(b.collision||"flip").split(" "),n=b.offset?b.offset.split(" "):[0,0],r,u,p;return 9===m.nodeType?(r=g.width(),u=g.height(),p={top:0,left:0}):m.setTimeout?(r=g.width(),u=g.height(),p={top:g.scrollTop(),left:g.scrollLeft()}):m.preventDefault?(b.at="left top",r=u=0,p={top:b.of.pageY,
left:b.of.pageX}):(r=g.outerWidth(),u=g.outerHeight(),p=g.offset()),a.each(["my","at"],function(){var a=(b[this]||"").split(" ");1===a.length&&(a=c.test(a[0])?a.concat(["center"]):d.test(a[0])?["center"].concat(a):["center","center"]);a[0]=c.test(a[0])?a[0]:"center";a[1]=d.test(a[1])?a[1]:"center";b[this]=a}),1===l.length&&(l[1]=l[0]),n[0]=parseInt(n[0],10)||0,1===n.length&&(n[1]=n[0]),n[1]=parseInt(n[1],10)||0,"right"===b.at[0]?p.left+=r:"center"===b.at[0]&&(p.left+=r/2),"bottom"===b.at[1]?p.top+=
u:"center"===b.at[1]&&(p.top+=u/2),p.left+=n[0],p.top+=n[1],this.each(function(){var e=a(this),d=e.outerWidth(),c=e.outerHeight(),g=parseInt(a.curCSS(this,"marginLeft",!0))||0,k=parseInt(a.curCSS(this,"marginTop",!0))||0,m=d+g+(parseInt(a.curCSS(this,"marginRight",!0))||0),w=c+k+(parseInt(a.curCSS(this,"marginBottom",!0))||0),q=a.extend({},p),v;"right"===b.my[0]?q.left-=d:"center"===b.my[0]&&(q.left-=d/2);"bottom"===b.my[1]?q.top-=c:"center"===b.my[1]&&(q.top-=c/2);f.fractions||(q.left=Math.round(q.left),
q.top=Math.round(q.top));v={left:q.left-g,top:q.top-k};a.each(["left","top"],function(f,e){a.ui.position[l[f]]&&a.ui.position[l[f]][e](q,{targetWidth:r,targetHeight:u,elemWidth:d,elemHeight:c,collisionPosition:v,collisionWidth:m,collisionHeight:w,offset:n,my:b.my,at:b.at})});a.fn.bgiframe&&e.bgiframe();e.offset(a.extend(q,{using:b.using}))})};a.ui.position={fit:{left:function(b,f){var e=a(window),e=f.collisionPosition.left+f.collisionWidth-e.width()-e.scrollLeft();b.left=0<e?b.left-e:Math.max(b.left-
f.collisionPosition.left,b.left)},top:function(b,f){var e=a(window),e=f.collisionPosition.top+f.collisionHeight-e.height()-e.scrollTop();b.top=0<e?b.top-e:Math.max(b.top-f.collisionPosition.top,b.top)}},flip:{left:function(b,f){if("center"!==f.at[0]){var e=a(window),e=f.collisionPosition.left+f.collisionWidth-e.width()-e.scrollLeft(),d="left"===f.my[0]?-f.elemWidth:"right"===f.my[0]?f.elemWidth:0,c="left"===f.at[0]?f.targetWidth:-f.targetWidth,g=-2*f.offset[0];b.left+=0>f.collisionPosition.left?d+
c+g:0<e?d+c+g:0}},top:function(b,f){if("center"!==f.at[1]){var e=a(window),e=f.collisionPosition.top+f.collisionHeight-e.height()-e.scrollTop(),d="top"===f.my[1]?-f.elemHeight:"bottom"===f.my[1]?f.elemHeight:0,c="top"===f.at[1]?f.targetHeight:-f.targetHeight,g=-2*f.offset[1];b.top+=0>f.collisionPosition.top?d+c+g:0<e?d+c+g:0}}}};a.offset.setOffset||(a.offset.setOffset=function(b,f){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var e=a(b),d=e.offset(),c=parseInt(a.curCSS(b,"top",
!0),10)||0,g=parseInt(a.curCSS(b,"left",!0),10)||0,d={top:f.top-d.top+c,left:f.left-d.left+g};"using"in f?f.using.call(b,d):e.css(d)},a.fn.offset=function(b){var f=this[0];return f&&f.ownerDocument?b?a.isFunction(b)?this.each(function(f){a(this).offset(b.call(this,f,a(this).offset()))}):this.each(function(){a.offset.setOffset(this,b)}):g.call(this):null});a.curCSS||(a.curCSS=a.css);(function(){var b=document.getElementsByTagName("body")[0],e=document.createElement("div"),d,c;d=document.createElement(b?
"div":"body");c={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};b&&a.extend(c,{position:"absolute",left:"-1000px",top:"-1000px"});for(var g in c)d.style[g]=c[g];d.appendChild(e);c=b||document.documentElement;c.insertBefore(d,c.firstChild);e.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;";e=a(e).offset(function(a,b){return b}).offset();d.innerHTML="";c.removeChild(d);b=e.top+e.left+(b?2E3:0);f.fractions=21<b&&22>b})()})(jQuery);(function(a,b){var c={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},d={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};a.widget("ui.dialog",{options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",collision:"fit",using:function(b){var e=a(this).css(b).offset().top;0>e&&a(this).css("top",b.top-e)}},resizable:!0,
show:null,stack:!0,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");"string"!==typeof this.originalTitle&&(this.originalTitle="");this.options.title=this.options.title||this.originalTitle;var b=this,e=b.options,d=e.title||"&#160;",c=a.ui.dialog.getTitleId(b.element),k=(b.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+e.dialogClass).css({zIndex:e.zIndex}).attr("tabIndex",-1).css("outline",
0).keydown(function(d){e.closeOnEscape&&d.keyCode&&d.keyCode===a.ui.keyCode.ESCAPE&&(b.close(d),d.preventDefault())}).attr({role:"dialog","aria-labelledby":c}).mousedown(function(a){b.moveToTop(!1,a)});b.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(k);var m=(b.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(k),l=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role",
"button").hover(function(){l.addClass("ui-state-hover")},function(){l.removeClass("ui-state-hover")}).focus(function(){l.addClass("ui-state-focus")}).blur(function(){l.removeClass("ui-state-focus")}).click(function(a){b.close(a);return!1}).appendTo(m);(b.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(e.closeText).appendTo(l);a("<span></span>").addClass("ui-dialog-title").attr("id",c).html(d).prependTo(m);a.isFunction(e.beforeclose)&&!a.isFunction(e.beforeClose)&&
(e.beforeClose=e.beforeclose);m.find("*").add(m).disableSelection();e.draggable&&a.fn.draggable&&b._makeDraggable();e.resizable&&a.fn.resizable&&b._makeResizable();b._createButtons(e.buttons);b._isOpen=!1;a.fn.bgiframe&&k.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();
this.originalTitle&&this.element.attr("title",this.originalTitle);return this},widget:function(){return this.uiDialog},close:function(b){var e=this,d,c;if(!1!==e._trigger("beforeClose",b))return e.overlay&&e.overlay.destroy(),e.uiDialog.unbind("keypress.ui-dialog"),e._isOpen=!1,e.options.hide?e.uiDialog.hide(e.options.hide,function(){e._trigger("close",b)}):(e.uiDialog.hide(),e._trigger("close",b)),a.ui.dialog.overlay.resize(),e.options.modal&&(d=0,a(".ui-dialog").each(function(){this!==e.uiDialog[0]&&
(c=a(this).css("z-index"),isNaN(c)||(d=Math.max(d,c)))}),a.ui.dialog.maxZ=d),e},isOpen:function(){return this._isOpen},moveToTop:function(b,e){var d=this.options;if(d.modal&&!b||!d.stack&&!d.modal)return this._trigger("focus",e);d.zIndex>a.ui.dialog.maxZ&&(a.ui.dialog.maxZ=d.zIndex);this.overlay&&(a.ui.dialog.maxZ+=1,this.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ));b={scrollTop:this.element.attr("scrollTop"),scrollLeft:this.element.attr("scrollLeft")};a.ui.dialog.maxZ+=1;
this.uiDialog.css("z-index",a.ui.dialog.maxZ);this.element.attr(b);this._trigger("focus",e);return this},open:function(){if(!this._isOpen){var b=this.options,e=this.uiDialog;this.overlay=b.modal?new a.ui.dialog.overlay(this):null;this._size();this._position(b.position);e.show(b.show);this.moveToTop(!0);b.modal&&e.bind("keypress.ui-dialog",function(b){if(b.keyCode===a.ui.keyCode.TAB){var f=a(":tabbable",this),e=f.filter(":first"),f=f.filter(":last");if(b.target===f[0]&&!b.shiftKey)return e.focus(1),
!1;if(b.target===e[0]&&b.shiftKey)return f.focus(1),!1}});a(this.element.find(":tabbable").get().concat(e.find(".ui-dialog-buttonpane :tabbable").get().concat(e.get()))).eq(0).focus();this._isOpen=!0;this._trigger("open");return this}},_createButtons:function(b){var e=this,d=!1,c=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),k=a("<div></div>").addClass("ui-dialog-buttonset").appendTo(c);e.uiDialog.find(".ui-dialog-buttonpane").remove();"object"===typeof b&&
null!==b&&a.each(b,function(){return!(d=!0)});d&&(a.each(b,function(b,f){f=a.isFunction(f)?{click:f,text:b}:f;b=a('<button type="button"></button>').attr(f,!0).unbind("click").click(function(){f.click.apply(e.element[0],arguments)}).appendTo(k);a.fn.button&&b.button()}),c.appendTo(e.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var e=this,d=e.options,c=a(document),k;e.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",
containment:"document",start:function(c,h){k="auto"===d.height?"auto":a(this).height();a(this).height(a(this).height()).addClass("ui-dialog-dragging");e._trigger("dragStart",c,b(h))},drag:function(a,d){e._trigger("drag",a,b(d))},stop:function(m,l){d.position=[l.position.left-c.scrollLeft(),l.position.top-c.scrollTop()];a(this).removeClass("ui-dialog-dragging").height(k);e._trigger("dragStop",m,b(l));a.ui.dialog.overlay.resize()}})},_makeResizable:function(f){function e(a){return{originalPosition:a.originalPosition,
originalSize:a.originalSize,position:a.position,size:a.size}}f=f===b?this.options.resizable:f;var d=this,c=d.options,k=d.uiDialog.css("position");f="string"===typeof f?f:"n,e,s,w,se,sw,ne,nw";d.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:d.element,maxWidth:c.maxWidth,maxHeight:c.maxHeight,minWidth:c.minWidth,minHeight:d._minHeight(),handles:f,start:function(b,f){a(this).addClass("ui-dialog-resizing");d._trigger("resizeStart",b,e(f))},resize:function(a,b){d._trigger("resize",
a,e(b))},stop:function(b,f){a(this).removeClass("ui-dialog-resizing");c.height=a(this).height();c.width=a(this).width();d._trigger("resizeStop",b,e(f));a.ui.dialog.overlay.resize()}}).css("position",k).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var e=[],d=[0,0],c;if(b){if("string"===typeof b||"object"===typeof b&&"0"in b)e=b.split?b.split(" "):
[b[0],b[1]],1===e.length&&(e[1]=e[0]),a.each(["left","top"],function(a,b){+e[a]===e[a]&&(d[a]=e[a],e[a]=b)}),b={my:e.join(" "),at:e.join(" "),offset:d.join(" ")};b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;(c=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(a.extend({of:window},b));c||this.uiDialog.hide()},_setOptions:function(b){var e=this,g={},h=!1;a.each(b,function(a,b){e._setOption(a,b);a in
c&&(h=!0);a in d&&(g[a]=b)});h&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",g)},_setOption:function(b,d){var c=this.uiDialog;switch(b){case "beforeclose":b="beforeClose";break;case "buttons":this._createButtons(d);break;case "closeText":this.uiDialogTitlebarCloseText.text(""+d);break;case "dialogClass":c.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+d);break;case "disabled":d?c.addClass("ui-dialog-disabled"):
c.removeClass("ui-dialog-disabled");break;case "draggable":var h=c.is(":data(draggable)");h&&!d&&c.draggable("destroy");!h&&d&&this._makeDraggable();break;case "position":this._position(d);break;case "resizable":(h=c.is(":data(resizable)"))&&!d&&c.resizable("destroy");h&&"string"===typeof d&&c.resizable("option","handles",d);!h&&!1!==d&&this._makeResizable(d);break;case "title":a(".ui-dialog-title",this.uiDialogTitlebar).html(""+(d||"&#160;"))}a.Widget.prototype._setOption.apply(this,arguments)},
_size:function(){var b=this.options,d,c,h=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});b.minWidth>b.width&&(b.width=b.minWidth);d=this.uiDialog.css({height:"auto",width:b.width}).height();c=Math.max(0,b.minHeight-d);"auto"===b.height?a.support.minHeight?this.element.css({minHeight:c,height:"auto"}):(this.uiDialog.show(),b=this.element.css("height","auto").height(),h||this.uiDialog.hide(),this.element.height(Math.max(b,c))):this.element.height(Math.max(b.height-
d,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}});a.extend(a.ui.dialog,{version:"1.8.9",uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");a||(a=this.uuid+=1);return"ui-dialog-title-"+a},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}});a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus mousedown mouseup keydown keypress click".split(" "),function(a){return a+".dialog-overlay"}).join(" "),
create:function(b){0===this.instances.length&&(setTimeout(function(){a.ui.dialog.overlay.instances.length&&a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return!1})},1),a(document).bind("keydown.dialog-overlay",function(d){b.options.closeOnEscape&&d.keyCode&&d.keyCode===a.ui.keyCode.ESCAPE&&(b.close(d),d.preventDefault())}),a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize));var d=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),
height:this.height()});a.fn.bgiframe&&d.bgiframe();this.instances.push(d);return d},destroy:function(b){var d=a.inArray(b,this.instances);-1!=d&&this.oldInstances.push(this.instances.splice(d,1)[0]);0===this.instances.length&&a([document,window]).unbind(".dialog-overlay");b.remove();var c=0;a.each(this.instances,function(){c=Math.max(c,this.css("z-index"))});this.maxZ=c},height:function(){var b,d;return a.browser.msie&&7>a.browser.version?(b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),
d=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),b<d?a(window).height()+"px":b+"px"):a(document).height()+"px"},width:function(){var b,d;return a.browser.msie&&7>a.browser.version?(b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),d=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),b<d?a(window).width()+"px":b+"px"):a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=b.add(this)});
b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}});a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);(function(a){var b=0,c=0;a.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:!1,cookie:null,collapsible:!1,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:'<li><a href="#{href}"><span>#{label}</span></a></li>'},_create:function(){this._tabify(!0)},_setOption:function(a,b){"selected"==a?this.options.collapsible&&b==this.options.selected||this.select(b):
(this.options[a]=b,this._tabify())},_tabId:function(a){return a.title&&a.title.replace(/\s/g,"_").replace(/[^A-Za-z0-9\-_:\.]/g,"")||this.options.idPrefix+ ++b},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++c);return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=
a(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(b){function c(b,d){b.css({display:""});!a.support.opacity&&d.opacity&&b[0].style.removeAttribute("filter")}this.list=this.element.find("ol,ul").eq(0);this.lis=a("li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return a("a",this)[0]});this.panels=a([]);var e=this,g=this.options,h=/^#.+/;this.anchors.each(function(b,d){var c=a(d).attr("href"),f=c.split("#")[0],k;f&&(f===location.toString().split("#")[0]||
(k=a("base")[0])&&f===k.href)&&(c=d.hash,d.href=c);h.test(c)?e.panels=e.panels.add(e._sanitizeSelector(c)):"#"!=c?(a.data(d,"href.tabs",c),a.data(d,"load.tabs",c.replace(/#.*$/,"")),c=e._tabId(d),d.href="#"+c,d=a("#"+c),d.length||(d=a(g.panelTemplate).attr("id",c).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(e.panels[b-1]||e.list),d.data("destroy.tabs",!0)),e.panels=e.panels.add(d)):g.disabled.push(b)});b?(this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),
this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.lis.addClass("ui-state-default ui-corner-top"),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"),void 0===g.selected?(location.hash&&this.anchors.each(function(a,b){if(b.hash==location.hash)return g.selected=a,!1}),"number"!=typeof g.selected&&g.cookie&&(g.selected=parseInt(e._cookie(),10)),"number"!=typeof g.selected&&this.lis.filter(".ui-tabs-selected").length&&(g.selected=
this.lis.index(this.lis.filter(".ui-tabs-selected"))),g.selected=g.selected||(this.lis.length?0:-1)):null===g.selected&&(g.selected=-1),g.selected=0<=g.selected&&this.anchors[g.selected]||0>g.selected?g.selected:0,g.disabled=a.unique(g.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(a){return e.lis.index(a)}))).sort(),-1!=a.inArray(g.selected,g.disabled)&&g.disabled.splice(a.inArray(g.selected,g.disabled),1),this.panels.addClass("ui-tabs-hide"),this.lis.removeClass("ui-tabs-selected ui-state-active"),
0<=g.selected&&this.anchors.length&&(this.panels.eq(g.selected).removeClass("ui-tabs-hide"),this.lis.eq(g.selected).addClass("ui-tabs-selected ui-state-active"),e.element.queue("tabs",function(){e._trigger("show",null,e._ui(e.anchors[g.selected],e.panels[g.selected]))}),this.load(g.selected)),a(window).bind("unload",function(){e.lis.add(e.anchors).unbind(".tabs");e.lis=e.anchors=e.panels=null})):g.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));this.element[g.collapsible?"addClass":
"removeClass"]("ui-tabs-collapsible");g.cookie&&this._cookie(g.selected,g.cookie);b=0;for(var k;k=this.lis[b];b++)a(k)[-1==a.inArray(b,g.disabled)||a(k).hasClass("ui-tabs-selected")?"removeClass":"addClass"]("ui-state-disabled");!1===g.cache&&this.anchors.removeData("cache.tabs");this.lis.add(this.anchors).unbind(".tabs");if("mouseover"!=g.event){var m=function(a,b){b.is(":not(.ui-state-disabled)")&&b.addClass("ui-state-"+a)};this.lis.bind("mouseover.tabs",function(){m("hover",a(this))});this.lis.bind("mouseout.tabs",
function(){a(this).removeClass("ui-state-hover")});this.anchors.bind("focus.tabs",function(){m("focus",a(this).closest("li"))});this.anchors.bind("blur.tabs",function(){a(this).closest("li").removeClass("ui-state-focus")})}var l,n;g.fx&&(a.isArray(g.fx)?(l=g.fx[0],n=g.fx[1]):l=n=g.fx);var r=n?function(b,d){a(b).closest("li").addClass("ui-tabs-selected ui-state-active");d.hide().removeClass("ui-tabs-hide").animate(n,n.duration||"normal",function(){c(d,n);e._trigger("show",null,e._ui(b,d[0]))})}:function(b,
d){a(b).closest("li").addClass("ui-tabs-selected ui-state-active");d.removeClass("ui-tabs-hide");e._trigger("show",null,e._ui(b,d[0]))},u=l?function(a,b){b.animate(l,l.duration||"normal",function(){e.lis.removeClass("ui-tabs-selected ui-state-active");b.addClass("ui-tabs-hide");c(b,l);e.element.dequeue("tabs")})}:function(a,b){e.lis.removeClass("ui-tabs-selected ui-state-active");b.addClass("ui-tabs-hide");e.element.dequeue("tabs")};this.anchors.bind(g.event+".tabs",function(){var b=this,d=a(this).closest("li"),
c=e.panels.filter(":not(.ui-tabs-hide)"),f=a(e._sanitizeSelector(this.hash));if(d.hasClass("ui-tabs-selected")&&!g.collapsible||d.hasClass("ui-state-disabled")||d.hasClass("ui-state-processing")||!1===e._trigger("select",null,e._ui(this,f[0])))return this.blur(),!1;g.selected=e.anchors.index(this);e.abort();if(g.collapsible){if(d.hasClass("ui-tabs-selected"))return g.selected=-1,g.cookie&&e._cookie(g.selected,g.cookie),e.element.queue("tabs",function(){u(b,c)}).dequeue("tabs"),this.blur(),!1;if(!c.length)return g.cookie&&
e._cookie(g.selected,g.cookie),e.element.queue("tabs",function(){r(b,f)}),e.load(e.anchors.index(this)),this.blur(),!1}g.cookie&&e._cookie(g.selected,g.cookie);if(f.length)c.length&&e.element.queue("tabs",function(){u(b,c)}),e.element.queue("tabs",function(){r(b,f)}),e.load(e.anchors.index(this));else throw"jQuery UI Tabs: Mismatching fragment identifier.";a.browser.msie&&this.blur()});this.anchors.bind("click.tabs",function(){return!1})},destroy:function(){var b=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");
this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var b=a.data(this,"href.tabs");b&&(this.href=b);var d=a(this).unbind(".tabs");a.each(["href","load","cache"],function(a,b){d.removeData(b+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){a.data(this,"destroy.tabs")?a(this).remove():a(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")});
b.cookie&&this._cookie(null,b.cookie);return this},add:function(b,c,e){void 0===e&&(e=this.anchors.length);var g=this,h=this.options;c=a(h.tabTemplate.replace(/#\{href\}/g,b).replace(/#\{label\}/g,c));b=b.indexOf("#")?this._tabId(a("a",c)[0]):b.replace("#","");c.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);var k=a("#"+b);k.length||(k=a(h.panelTemplate).attr("id",b).data("destroy.tabs",!0));k.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");e>=this.lis.length?
(c.appendTo(this.list),k.appendTo(this.list[0].parentNode)):(c.insertBefore(this.lis[e]),k.insertBefore(this.panels[e]));h.disabled=a.map(h.disabled,function(a){return a>=e?++a:a});this._tabify();1==this.anchors.length&&(h.selected=0,c.addClass("ui-tabs-selected ui-state-active"),k.removeClass("ui-tabs-hide"),this.element.queue("tabs",function(){g._trigger("show",null,g._ui(g.anchors[0],g.panels[0]))}),this.load(0));this._trigger("add",null,this._ui(this.anchors[e],this.panels[e]));return this},remove:function(b){var c=
this.options,e=this.lis.eq(b).remove(),g=this.panels.eq(b).remove();e.hasClass("ui-tabs-selected")&&1<this.anchors.length&&this.select(b+(b+1<this.anchors.length?1:-1));c.disabled=a.map(a.grep(c.disabled,function(a){return a!=b}),function(a){return a>=b?--a:a});this._tabify();this._trigger("remove",null,this._ui(e.find("a")[0],g[0]));return this},enable:function(b){var c=this.options;if(-1!=a.inArray(b,c.disabled))return this.lis.eq(b).removeClass("ui-state-disabled"),c.disabled=a.grep(c.disabled,
function(a){return a!=b}),this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b])),this},disable:function(a){var b=this.options;a!=b.selected&&(this.lis.eq(a).addClass("ui-state-disabled"),b.disabled.push(a),b.disabled.sort(),this._trigger("disable",null,this._ui(this.anchors[a],this.panels[a])));return this},select:function(a){"string"==typeof a?a=this.anchors.index(this.anchors.filter("[href$="+a+"]")):null===a&&(a=-1);-1==a&&this.options.collapsible&&(a=this.options.selected);this.anchors.eq(a).trigger(this.options.event+
".tabs");return this},load:function(b){var c=this,e=this.options,g=this.anchors.eq(b)[0],h=a.data(g,"load.tabs");this.abort();if(!h||0!==this.element.queue("tabs").length&&a.data(g,"cache.tabs"))this.element.dequeue("tabs");else{this.lis.eq(b).addClass("ui-state-processing");if(e.spinner){var k=a("span",g);k.data("label.tabs",k.html()).html(e.spinner)}this.xhr=a.ajax(a.extend({},e.ajaxOptions,{url:h,success:function(h,k){a(c._sanitizeSelector(g.hash)).html(h);c._cleanup();e.cache&&a.data(g,"cache.tabs",
!0);c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{e.ajaxOptions.success(h,k)}catch(n){}},error:function(a,h){c._cleanup();c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{e.ajaxOptions.error(a,h,b,g)}catch(k){}}}));c.element.dequeue("tabs");return this}},abort:function(){this.element.queue([]);this.panels.stop(!1,!0);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));this.xhr&&(this.xhr.abort(),delete this.xhr);this._cleanup();return this},url:function(a,b){this.anchors.eq(a).removeData("cache.tabs").data("load.tabs",
b);return this},length:function(){return this.anchors.length}});a.extend(a.ui.tabs,{version:"1.8.2"});a.extend(a.ui.tabs.prototype,{rotation:null,rotate:function(a,b){var c=this,g=this.options,h=c._rotate||(c._rotate=function(b){clearTimeout(c.rotation);c.rotation=setTimeout(function(){var a=g.selected;c.select(++a<c.anchors.length?a:0)},a);b&&b.stopPropagation()});b=c._unrotate||(c._unrotate=b?function(){t=g.selected;h()}:function(a){a.clientX&&c.rotate(null)});a?(this.element.bind("tabsshow",h),
this.anchors.bind(g.event+".tabs",b),h()):(clearTimeout(c.rotation),this.element.unbind("tabsshow",h),this.anchors.unbind(g.event+".tabs",b),delete this._rotate,delete this._unrotate);return this}})})(jQuery);(function(a){a.storage=new a.store;a.wa.errorHandler=function(b){a.storage.del("site/"+a.wa.site.domain+"/hash");return 404==b.status?(a.wa.setHash("#/"),!1):!0};a.wa.site={options:[],domain:0,helper:"",init:function(b){"undefined"!=typeof a.History&&a.History.bind(function(){a.wa.site.dispatch()});this.domain=b.domain;this.options=b;b=window.location.hash;"#/"!==b&&b?a.wa.setHash(b):(b=a.storage.get("site/"+this.domain+"/hash"))&&null!=b?a.wa.setHash("#/"+b):this.dispatch()},setHelper:function(b){if(!0===
b)return!1;b?(this.helper=b,a("#s-save-panel div.s-dropdown").show()):(this.helper="",a("#s-save-panel div.s-dropdown").hide())},dispatch:function(b){void 0==b&&(b=window.location.hash);if(b=b.replace(/^[^#]*#\/*/,""))if(b=b.split("/"),b[0]){for(var c="",d=b.length,f=0;f<b.length;f++){var e=b[f];if(2>f)if(0===f)c=e;else{if("files"==c){this.filesAction(b.slice(f).join("/"));return}if(parseInt(e,10)!=e&&-1==e.indexOf("=")&&"plugins"!=c)c+=e.substr(0,1).toUpperCase()+e.substr(1);else{d=f;break}}else{d=
f;break}}d=b.slice(d);this[c+"Action"]?(this[c+"Action"].apply(this,d),a.storage.set("site/"+this.domain+"/hash",b.join("/"))):console&&console.log("Invalid action name:",c+"Action")}else this.defaultAction();else this.defaultAction()},defaultAction:function(){var b=a("div.s-sidebar ul.s-links a:first").attr("href");a.wa.setHash(b)},pagesAction:function(b){a("#wa-page-container").length?waLoadPage(b):(a("#s-save-panel input").replaceWith('<input id="wa-page-button" type="button" class="button green" value="'+
$_("Save")+'">'),a("#s-content").load("?module=pages","domain_id="+this.domain+(b?"&id="+b:""),function(){a.wa.site.savePanel(!0,"s-page-editor");a.wa.site.active(a("#s-link-pages"));a("#wa-page-button").click(function(){a("#wa-page-form").submit()})}))},newsiteAction:function(b){b=this.parseParams(b);a("#domain-name").val(b.domain||"");a("#addsite-dialog span.error").empty().hide();a("#addsite-dialog").waDialog({onSubmit:function(){var b=a(this);a.post(b.attr("action"),b.serialize(),function(b){"ok"==
b.status?location.href="?domain_id="+b.data.id+"#/settings/":"fail"==b.status&&a("#addsite-dialog span.error").html(b.errors).show()},"json");return!1}});a("#s-content .triple-padded .loading").length&&this.defaultAction()},designAction:function(b){a("#wa-design-container").length?(waDesignLoad(void 0===b?"":b),a.wa.site.savePanel(b&&(-1!=b.indexOf("action=edit")||-1!=b.indexOf("file="))),a("#wa-design-button").removeClass("yellow").addClass("green")):(this.parseParams(b),a("#s-save-panel input").replaceWith('<input id="wa-design-button" type="button" class="button green" value="'+
$_("Save")+'">'),a("#s-content").load("?module=design","domain_id="+this.domain,function(){a.wa.site.savePanel(b&&(-1!=b.indexOf("action=edit")||-1!=b.indexOf("file=")));a.wa.site.active(a("#s-link-design"));a("#wa-design-button").click(function(){a("#wa-design-form").submit()});waDesignLoad(void 0===b?"":b)}))},themesAction:function(b){this.savePanel(!1);a("#wa-design-container").length?waDesignLoad():a("#s-content").load("?module=design","domain_id="+this.domain,function(){a.wa.site.active(a("#s-link-design"));
waDesignLoad()})},designAddAction:function(a){this.designAction(a+"&file=")},filesPage:function(a){a||(a=location.hash);a=a.split("/");return(a=a[a.length-1])&&"?"==a.substr(0,1)&&(a=a.substr(1).split("="),"page"==a[0])?a[1]:1},pluginsAction:function(b){this.savePanel(!1);a("#wa-plugins-container").length?a.plugins.dispatch(b):a("#s-content").load("?module=plugins",{},function(){a.wa.site.active(a("#s-link-plugins"))})},filesAction:function(b,c){this.savePanel(!1);var d=1;if(!0===b)var f=c||this.filesPath();
else f=Array.prototype.join.call(arguments,"/"),b=!1;if(f&&-1!=f.indexOf("?")&&"/"!=f.substr(-1)){var e=f.substr(f.indexOf("?")+1),f=f.substr(0,f.indexOf("?")),e=e.split("=");"page"==e[0]&&(d=e[1])}var g=function(){a.wa.site.active(a("#s-link-files"));a("#s-files-tree li.selected").removeClass("selected");if(f){a("a.s-baseurl").removeClass("selected");a("#s-folder-actions-li").show();var b=a("#s-files-tree a[href='#/files/"+f+"']");b.parent().addClass("selected");for(b=b.parent();b.length;){var c=
b.find("> i.overhanging");c.hasClass("rarr")&&c.click();b=b.parent("ul").parent("li")}}else a("#s-folder-actions-li").hide(),a("a.s-baseurl").addClass("selected");a.wa.site.filesList(f,d);a("#s-upload-path").val(f||"");a("#s-current-path").html("/"+(f||""));a("#s-files-count").html("0");a("#s-files-grid input.all").removeAttr("checked")};a("#s-files-tree").length&&!b?g():a("#s-content").load("?module=files","domain_id="+this.domain,function(){a("#s-files-tree i.overhanging").click(function(){var b=
a(this);b.hasClass("rarr")?b.removeClass("rarr").addClass("darr").parent().children("ul").show():b.removeClass("darr").addClass("rarr").parent().children("ul").hide()});!0===b&&c?a.wa.setHash("#/files/"+c):g()})},filesList:function(b,c){b||(b=this.filesPath());c||(c=this.filesPage());var d="http://"+this.options.domain_url+"/wa-data/public/site/"+a.wa.site.filesPath();a.post("?module=files&action=list&page="+c,{path:b},function(f){a("#s-files-grid tr.s-file").remove();a("div.s-pagination").empty();
for(var e=0;e<f.data.files.length;e++){var g=f.data.files[e],g='<tr class="s-file"><td class="min-width"><input type="checkbox" value="'+g.file+'" /></td><td><ul class="menu-h dropdown clickable"><li><a href="'+d+g.file+'"><i class="icon16 '+g.type+'"></i> '+g.file+' <i class="icon10 darr no-overhanging s-file-actions"></i></a></li></ul></td><td>'+g.datetime+'</td><td><span class="float-right">'+a.wa.site.getFileSize(g.size)+"</span></td></tr>";a("#s-files-grid").append(g)}if(1<f.data.pages){g='<ul class="menu-h">';
for(e=1;e<=f.data.pages;e++)g+="<li"+(e==c?' class="selected"':"")+'><a href="#/files/'+b+"?page="+e+'">'+e+"</a></li>";g+="</ul>";a("div.s-pagination").html(g).show()}},"json")},getFileSize:function(a){return 1024>a?a+" B":1048576>a?Math.round(a/1024)+" KB":1073741824>a?Math.round(a/1048576)+" MB":Math.round(a/1073741824)+" GB"},checkFileType:function(a){return"image"==a||"text"==a||"script-css"==a||"script-js"==a},getFileMenu:function(b){var c=this.options.domain_url+"/wa-data/public/site/"+a.wa.site.filesPath()+
b,d=a('<ul class="menu-v width-icons" style="display:block"></ul>');".php"!=b.substr(-4)&&".phtml"!=b.substr(-6)&&"."!=b.substr(0,1)&&d.append('<li><i class="icon16 globe"></i>'+$_("File URL")+': <a href="http://'+c+'" target="_blank" class="bold">'+c+'<i class="icon10 new-window"></i></a></li>');".php"!=b.substr(-4)&&".phtml"!=b.substr(-6)&&d.append('<li><a href="?module=files&action=download&path='+a.wa.site.filesPath()+"&file="+b+'"><i class="icon16 download"></i>'+$_("Download")+"</a></li>");
d.append(a("<li></li>").append('<a href="#"><i class="icon16 edit"></i>'+$_("Rename")+"</a>").click(function(){a("#s-rename-dialog").waDialog({disableButtonsOnSubmit:!0,onLoad:function(){a("#s-name").val(b).focus().select();a(this).find("span").html(a.wa.site.filesPath(!0))},onSubmit:function(){var c=a("#s-name").val();a.post("?module=files&action=rename",{path:a.wa.site.filesPath(),name:c,file:b},function(b){"ok"==b.status?(a.wa.site.filesList(),a("#s-rename-dialog").hide()):"fail"==b.status&&(alert(b.errors),
a("#s-rename-dialog input[type=submit]").removeAttr("disabled"))},"json");return!1}});return!1}));d.append(a("<li></li>").append('<a href="#"><i class="icon16 move"></i>'+$_("Move to folder")+"</a>").click(function(){a("#s-move-dialog select").html(a.wa.site.filesPathOptions(a("#s-files-tree > ul.s-folderlist"),""));a("#s-move-dialog-files").html('<input type="hidden" name="file" value="'+b+'" />');a("#s-move-dialog input[name=path]").val(a.wa.site.filesPath());a("#s-move-dialog h1 span").empty();
a("#s-move-dialog").waDialog({disableButtonsOnSubmit:!0,onSubmit:function(){a.post("?module=files&action=move",a("#s-move-dialog form").serialize(),function(b){"ok"==b.status?(a("#s-move-dialog").hide(),a.wa.site.filesList()):"fail"==b.status&&(alert(b.errors),a("#s-move-dialog input[type=submit]").removeAttr("disabled"))},"json");return!1}});return!1}));d.append(a("<li></li>").append('<a href="#"><i class="icon16 delete"></i>'+$_("Delete")+"</a>").click(function(){a("#s-delete-dialog").waDialog({content:"<h1>"+
$_("Delete file")+"</h1><p>"+$_("File")+" <b>"+b+"</b> "+$_("will be deleted without the ability to recover.")+"</p>",disableButtonsOnSubmit:!0,onSubmit:function(){a.post("?module=files&action=delete",{path:a.wa.site.filesPath(),file:b},function(b){"ok"==b.status?(a.wa.site.filesList(),a("#s-delete-dialog").hide()):"fail"==b.status&&(alert(b.errors),a("#s-delete-dialog input[type=submit]").removeAttr("disabled"))},"json")}});return!1}));return d},settingsAction:function(b){this.savePanel(!1);a("#s-content").load("?module=settings&domain_id="+
this.domain,function(){a.wa.site.active(a("#s-link-settings"))})},settingsRoutingAction:function(){this.settingsAction("routing")},blocksAction:function(b){a("#s-save-panel input").replaceWith('<input id="s-editor-save-button" type="button" class="button green" value="'+$_("Save")+'">');a("#s-content").load("?module=blocks",b,function(){waEditorAceInit({id:"content",save_button:"s-editor-save-button"});a("#s-editor-save-button").click(function(){a("#site-form").submit()});a.wa.site.savePanel(!0);
a.wa.site.setHelper("app=");a.wa.site.active(a("#s-link-blocks"))})},blocksAddAction:function(){this.blocksAction("id=")},active:function(b){a(".sidebar a.selected").removeClass("selected");a("ul.s-links li.selected").removeClass("selected");b&&b.length&&b.addClass("selected")},routingAction:function(b){this.savePanel(!1);a("#s-content").load("?module=routing","domain_id="+this.domain,function(){a.wa.site.active(a("#s-link-routing"));a("tr#route-"+b+" .s-route-settings").click()})},personalSettingsAction:function(b){var c=
this.domain;this.savePanel(!1);var d=function(){a("#s-personal-content").html('<i class="icon16 loading"></i>').load("?module=personal&action=settings&hash="+(b||""),"domain_id="+c,function(){a("ul.s-personal-structure li.selected").removeClass("selected")})};a("#s-personal-content").length?d():this.personalAction(d)},personalAppAction:function(b){var c=this.domain;this.savePanel(!1);var d=function(){a("#s-personal-content").html('<i class="icon16 loading"></i>').load("?module=personal&action=app&app_id="+
b,"domain_id="+c,function(){a("ul.s-personal-structure li.selected").removeClass("selected");a("#s-personal-app-"+b).addClass("selected");a("#s-app-frontend-link").html(a("#s-personal-app-"+b).data("link")).attr("href",a("#s-personal-app-"+b).data("link"))})};a("#s-personal-content").length?d():this.personalAction(d)},personalProfileAction:function(){var b=this.domain;this.savePanel(!1);var c=function(){a("#s-personal-content").html('<i class="icon16 loading"></i>').load("?module=personal&action=profile",
"domain_id="+b,function(){a("ul.s-personal-structure li.selected").removeClass("selected");a("#s-personal-profile-link").addClass("selected")})};a("#s-personal-content").length?c():this.personalAction(c)},personalAction:function(b){this.savePanel(!1);a("#s-content").load("?module=personal","domain_id="+this.domain,function(){a.wa.site.active(a("#s-link-personal"));b?b():a("#s-personal-settings-link").data("enabled")?a.wa.setHash(a("ul.s-personal-structure a:first").attr("href")):a.wa.setHash("#/personal/settings/")})},
parseParams:function(a){if(!a)return{};a=a.split("&");var c={};for(i=0;i<a.length;i++){var d=a[i].split("=");c[d[0]]=1<d.length?d[1]:""}return c},savePanel:function(b,c){b?(a("#s-save-panel").show(),a("#s-save-panel input").removeClass("yellow").addClass("green"),a("#wa-editor-status").empty(),c?a("#s-save-panel .s-bottom-fixed-bar-content-offset").addClass(c):a("#s-save-panel .s-bottom-fixed-bar-content-offset").attr("class","s-bottom-fixed-bar-content-offset")):a("#s-save-panel").hide()},getTreeHTML:function(a,
c,d){d=d||"";c="<ul"+(c?"":' style="display:none"')+' class="menu-v with-icons'+(c?" "+c:"")+'">';for(var f="",e=0;e<a.length;e++)f="string"==typeof a[e]?a[e]:a[e].id,c+="<li>","string"!=typeof a[e]&&(c+='<i class="icon16 rarr overhanging"></i>'),c+='<a href="#/files/'+d+f+'/"><i class="icon16 folder"></i><b>'+f+"</b></a>","string"!=typeof a[e]&&(c+=this.getTreeHTML(a[e].childs,!1,d+f+"/")),c+="</li>";return c+"</ul>"},filesPath:function(b){b=b?"wa-data/public/site/":"";return a("#s-files-tree li.selected").length?
b+a("#s-files-tree li.selected a").attr("href").substr(8):b},filesPathOptions:function(b,c,d){c=c||"";var f="";""==c&&(f='<option value="">wa-data/public/site</a>',c="&nbsp;&nbsp;&nbsp;");d=d||!1;b.children("li").each(function(){var b=d&&a(this).find("> ul > li.selected").length||!d&&a(this).hasClass("selected")?!0:!1,g=a(this).children("a");f+="<option "+(b?'selected="selected"':"")+' value="'+g.attr("href").substr(8)+'">'+c+g.children("b").html()+"</option>";!a(this).children("ul").length||d&&a(this).hasClass("selected")||
(f+=a.wa.site.filesPathOptions(a(this).children("ul"),c+"&nbsp;&nbsp;&nbsp;",d))});return f}}})(jQuery);
$(function(){$(".s-add-new-site").live("click",function(){$.wa.site.newsiteAction();return!1});$("#s-helper-link").click(function(){if($("#s-helper").is(":visible"))return $("#s-helper").hide(),!1;$("#s-helper").load("?module=helper",$.wa.site.helper,function(){$(this).show();var a=function(b){if("s-helper"==$(b.target).attr("id")||$(b.target).parents("#s-helper").length)$(document).one("click",a);else $("#s-helper").hide()};$(document).one("click",a)});return!1});$("#s-helper div.fields a.inline-link").live("click",
function(){var a=$(this).find("i");a.children("b").length&&(a=a.children("b"));$("#wa-page-content").length?$("#wa-page-content").waEditor("insert",a.text()):wa_editor.insert(a.text());return!1});$("#wa-app > div.s-sidebar a, #wa-header a").live("click",function(){if($("#s-save-panel").is(":visible")&&$("#s-save-panel input:button").hasClass("yellow"))return confirm($_("Unsaved changes will be lost if you leave this page now. Are you sure?"))})});
//# sourceMappingURL=site-jquery.min.js.map